<!DOCTYPE html>
<html lang="ja">
<head>
    <style>
        /* /* CodePenの外部設定でTailwind CSSとFont Awesomeを読み込むため、
   HTMLにあった<script>と<link>は不要です */

body { font-family: sans-serif; background: #f0f2f5; color: #333; margin: 0; padding: 0; overflow: hidden; }
.slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; opacity: 0; transform: translateY(50px); transition: all 0.4s ease-out; pointer-events: none; visibility: hidden; }
.slide.active { opacity: 1; transform: translateY(0); pointer-events: all; visibility: visible; z-index: 10; }
.slide.prev { opacity: 0; transform: translateY(-50px); pointer-events: none; visibility: hidden; }
.input-group { width: 100%; max-width: 600px; background: rgba(255,255,255,0.95); padding: 25px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
.question-number { color: #2563eb; font-weight: bold; margin-bottom: 10px; font-size: 0.9rem; letter-spacing: 1px; text-transform: uppercase; }
.question-text { font-size: 1.6rem; font-weight: bold; margin-bottom: 25px; line-height: 1.4; color: #1f2937; }
input, textarea, select { width: 100%; padding: 15px; font-size: 1.3rem; border: 2px solid #e5e7eb; border-radius: 10px; outline: none; background: #fff; transition: border-color 0.3s; }
input:focus, textarea:focus, select:focus { border-color: #2563eb; }
.btn-choice { display: block; width: 100%; padding: 18px; margin-bottom: 12px; background: #fff; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 1.2rem; text-align: left; cursor: pointer; transition: all 0.2s; color: #4b5563; font-weight: 500; }
.btn-choice:hover { border-color: #93c5fd; background: #f0f9ff; }
.btn-choice.selected { border-color: #2563eb; background: #eff6ff; color: #1e40af; font-weight: bold; box-shadow: 0 0 0 2px rgba(37,99,235,0.2); }
.nav-buttons { position: fixed; bottom: 30px; right: 30px; z-index: 50; }
.btn-nav { background: #2563eb; color: white; border: none; padding: 16px 32px; border-radius: 50px; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(37,99,235,0.4); opacity: 0.5; pointer-events: none; transition: 0.3s; display: flex; align-items: center; gap: 10px; }
.btn-nav.active { opacity: 1; pointer-events: all; transform: translateY(-2px); }
.btn-nav:active { transform: translateY(0); }
.result-box { background: #1f2937; color: #f3f4f6; padding: 20px; border-radius: 10px; font-family: monospace; white-space: pre-wrap; text-align: left; width: 100%; max-height: 300px; overflow-y: auto; margin: 20px 0; font-size: 0.95rem; border: 1px solid #374151; }
        
/* 読み込み中アニメーション */
.spinner { border: 4px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top: 4px solid #fff; width: 24px; height: 24px; animation: spin 1s linear infinite; display: none; margin-left: 10px; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
/* 時間外労働や苦情処理の入力欄を隠すためのスタイル */
.extra-time-inputs { display: none; margin-top: 15px; padding: 15px; border: 1px dashed #ccc; border-radius: 10px; }

/* CSSパネルのコードの末尾に追加 */
body, html {
    height: 100%; /* アプリがブラウザの高さに収まるように固定 */
} */
    </style>
</head>
<body><div class="slide active" id="slide-intro">
    <div class="text-center p-6">
        <div class="mb-6 text-6xl text-blue-600"><i class="fas fa-rocket"></i></div>
        <h1 class="text-4xl font-extrabold text-gray-800 mb-4">スグクル営業App v3.2</h1>
        <p class="mb-10 text-xl text-gray-500">Googleシート連携・自動保存版</p>
        <button onclick="nextSlide()" class="bg-blue-600 text-white px-10 py-4 rounded-full text-xl font-bold shadow-lg hover:bg-blue-700 transition transform hover:-translate-y-1">
            スタート
        </button>
    </div>
</div>

<div class="slide"><div class="input-group"><div class="question-number">1/16 契約条件</div><div class="question-text">契約の種別を選択してください</div>
    <button class="btn-choice" onclick="selectChoice('input-contract', '労働者派遣')">A. 労働者派遣</button>
    <button class="btn-choice" onclick="selectChoice('input-contract', '業務委託（請負）')">B. 業務委託（請負）</button>
    <button class="btn-choice" onclick="selectChoice('input-contract', '有料職業紹介')">C. 有料職業紹介</button>
    <button class="btn-choice" onclick="selectChoice('input-contract', '紹介予定派遣')">D. 紹介予定派遣</button>
    <input type="hidden" id="input-contract">
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">2/16 業務内容</div><div class="question-text">具体的な業務内容を入力してください</div>
    <textarea id="input-job-desc" rows="4" placeholder="例: 大根の収穫、洗浄、選別作業。リフト免許があれば尚可。" oninput="checkInput(this)"></textarea>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">3/16 就業場所</div><div class="question-text">就業場所の名称を入力してください</div>
    <textarea id="input-location" rows="3" placeholder="例: いぶすき農業協同組合 山川事業所" oninput="checkInput(this)"></textarea>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">4/16 期間</div><div class="question-text">派遣契約の開始日と終了予定日を選択してください</div>
    <label class="block text-gray-500 font-medium mb-1 mt-3 text-base">開始日</label>
    <input type="date" id="input-start-date" onchange="checkInput(this)" style="font-family: sans-serif; font-size: 1.2rem;">
    <label class="block text-gray-500 font-medium mb-1 mt-4 text-base">終了予定日</label>
    <input type="date" id="input-end-date" onchange="checkInput(this)" style="font-family: sans-serif; font-size: 1.2rem;">
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">5/16 勤務時間</div><div class="question-text">就業時間、休憩時間、休日を入力してください</div>
    <textarea id="input-time" rows="4" placeholder="例: 8:00〜17:00 (休憩60分 12:00〜13:00)&#10;休日: 土日祝休み" oninput="checkInput(this)"></textarea>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">6/16 時間外労働</div><div class="question-text">時間外労働の有無を選択し、上限を入力してください</div>
    <button class="btn-choice" id="choice-overtime-yes" onclick="toggleExtraTimeInputs('input-overtime', '有', true)">A. 有</button>
    <button class="btn-choice" id="choice-overtime-no" onclick="toggleExtraTimeInputs('input-overtime', '無', false)">B. 無</button>
    <input type="hidden" id="input-overtime">
    
    <div id="extra-time-fields" class="extra-time-inputs">
        <p class="text-sm font-bold mb-3 text-blue-600">— 時間外労働の具体的な上限 —</p>
        <div class="flex items-center mb-3">
            <input type="number" id="input-overtime-day" placeholder="0" class="w-1/3 mr-2 text-center" style="font-size:1.1rem; padding:10px;">
            <span class="text-lg">時間/日</span>
            <input type="number" id="input-overtime-week" placeholder="0" class="w-1/3 mx-2 text-center" style="font-size:1.1rem; padding:10px;">
            <span class="text-lg">時間/週</span>
        </div>
        <div class="flex items-center">
            <input type="number" id="input-overtime-month-hours" placeholder="0" class="w-1/3 mr-2 text-center" style="font-size:1.1rem; padding:10px;">
            <span class="text-lg">時間/月</span>
            <input type="number" id="input-overtime-month-days" placeholder="0" class="w-1/3 mx-2 text-center" style="font-size:1.1rem; padding:10px;">
            <span class="text-lg">日/月（回）</span>
        </div>
    </div>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">7/16 募集枠</div><div class="question-text">必要人数を入力してください</div>
    <div class="flex items-center gap-4">
        <input type="number" id="input-headcount" placeholder="3" oninput="checkInput(this)" class="text-center">
        <span class="text-2xl font-bold text-gray-500">名</span>
    </div>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">8/16 契約単価（税別）</div><div class="question-text">時給単価を免許の有無で入力してください</div>
    <label class="block text-gray-500 font-medium mb-1 mt-3 text-base">免許なし</label>
    <div class="flex items-center gap-4">
        <span class="text-2xl font-bold text-gray-500">¥</span>
        <input type="number" id="input-price-nomental" placeholder="1300" oninput="checkInput(this)">
    </div>
    <label class="block text-gray-500 font-medium mb-1 mt-4 text-base">免許持ち（例: リフトなど）</label>
    <div class="flex items-center gap-4">
        <span class="text-2xl font-bold text-gray-500">¥</span>
        <input type="number" id="input-price-mental" placeholder="1500 (該当なしなら空欄可)">
    </div>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">9/16 責任者</div><div class="question-text">指揮命令者（派遣先責任者）のお名前を入力してください</div>
    <input type="text" id="input-leader-name" placeholder="例: 物袋 夏樹" oninput="checkInput(this)">
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">10/16 苦情処理</div><div class="question-text">派遣先における苦情処理担当者を選択してください</div>
    <button class="btn-choice" id="choice-complaint-same" onclick="toggleComplaintInputs('input-complaint-role', '指揮命令者と同じ', false)">A. 指揮命令者と同じ</button>
    <button class="btn-choice" id="choice-complaint-other" onclick="toggleComplaintInputs('input-complaint-role', 'その他', true)">B. その他</button>
    <input type="hidden" id="input-complaint-role">
    
    <div id="complaint-fields" class="extra-time-inputs">
        <label class="block text-gray-500 font-medium mb-1 mt-3 text-base">お名前</label>
        <input type="text" id="input-complaint-name" placeholder="例: 営業部長 花子">
        <label class="block text-gray-500 font-medium mb-1 mt-4 text-base">連絡先</label>
        <input type="text" id="input-complaint-contact" placeholder="例: 0993-XX-XXXX">
    </div>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">11/16 派遣元責任者</div><div class="question-text">派遣元責任者（スグクル）を選択してください</div>
    <button class="btn-choice" onclick="selectChoice('input-our-pic', '壁 晃弘')">A. 壁 晃弘</button>
    <button class="btn-choice" onclick="selectChoice('input-our-pic', 'クレモ')">B. クレモ</button>
    <button class="btn-choice" onclick="selectChoice('input-our-pic', '吉原 伸')">C. 吉原 伸</button>
    <input type="hidden" id="input-our-pic">
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">12/16 寮</div><div class="question-text">寮の準備の要否を選択してください</div>
    <button class="btn-choice" onclick="selectChoice('input-dorm', '貴社で用意')">A. 貴社で用意</button>
    <button class="btn-choice" onclick="selectChoice('input-dorm', 'スグクルで用意')">B. スグクルで用意</button>
    <button class="btn-choice" onclick="selectChoice('input-dorm', '不要（自宅通勤）')">C. 不要（自宅通勤）</button>
    <input type="hidden" id="input-dorm">
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">13/16 送迎・通勤</div><div class="question-text">現場までの送迎・通勤方法を選択してください</div>
    <button class="btn-choice" id="choice-transport-company" onclick="selectChoiceAndShowNote('input-transport', '貴社送迎あり')">A. 貴社送迎あり</button>
    <button class="btn-choice" id="choice-transport-sugukuru" onclick="selectChoiceAndShowNote('input-transport', 'スグクル送迎')">B. スグクル送迎</button>
    <button class="btn-choice" id="choice-transport-self" onclick="selectChoiceAndShowNote('input-transport', '自力通勤')">C. 自力（免許・手段の確認）</button>
    <input type="hidden" id="input-transport">

        <div id="transport-self-fields" class="extra-time-inputs">
        <p class="text-sm font-bold mb-3 text-blue-600">— 自力通勤の手段と備考 —</p>
        <div class="grid grid-cols-2 gap-4">
            <div class="col-span-1">
                <label class="block text-gray-500 font-medium mb-1 text-base">手段</label>
                <select id="input-transport-means" class="text-base" style="font-size:1.1rem; padding:10px;" onchange="checkInput(this)">
                    <option value="">選択</option>
                    <option value="歩き">歩き</option>
                    <option value="自転車">自転車</option>
                    <option value="車">車</option>
                    <option value="公共交通機関">公共交通機関</option>
                </select>
            </div>
            <div class="col-span-1">
                <label class="block text-gray-500 font-medium mb-1 text-base">備考</label>
                <input type="text" id="input-transport-note" placeholder="例: 免許証の要否など" style="font-size:1.1rem; padding:10px;">
            </div>
        </div>
    </div>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">14/16 便宜供与</div><div class="question-text">便宜の供与（道具、車両等）を入力してください</div>
    <textarea id="input-convenience" rows="3" placeholder="例: 作業着は支給、自転車の貸し出しあり" oninput="checkInput(this)"></textarea>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">15/16 福利厚生</div><div class="question-text">福利厚生施設の利用等について記述してください</div>
    <textarea id="input-welfare" rows="3" placeholder="例: 食堂利用可（有料）、更衣室利用可" oninput="checkInput(this)"></textarea>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">16/16 担当者</div><div class="question-text">営業担当者（あなた）を選択してください</div>
    <select id="input-pic" onchange="checkInput(this)">
        <option value="">選択してください</option>
        <option value="壁 晃弘">A. 壁 晃弘</option>
        <option value="クレモ">B. クレモ</option>
        <option value="吉原 伸">C. 吉原 伸</option>
        <option value="その他">D. その他</option>
    </select>
</div></div>

<div class="slide"><div class="input-group"><div class="question-number">17/17 備考</div><div class="question-text">その他、特記事項や備考を入力してください</div>
    <textarea id="input-notes" rows="4" placeholder="特になければ空欄でOK" oninput="checkInput(this)"></textarea>
</div></div>


<div class="slide" id="slide-result">
    <div class="input-group text-center">
        <h2 class="text-2xl font-bold text-gray-800 mb-2">入力完了</h2>
        <div class="result-box" id="result-output"></div>

        <div class="grid gap-3">
                        <button onclick="copyText()" class="w-full bg-gray-600 text-white px-6 py-3 rounded-xl font-bold shadow hover:bg-gray-700 transition">
                <i class="fas fa-copy mr-2"></i> Slack用にコピー
            </button>

                        <button id="btn-send-sheet" onclick="sendToSheet()" class="w-full bg-green-600 text-white px-6 py-4 rounded-xl font-bold shadow-lg hover:bg-green-700 transition flex justify-center items-center">
                <span><i class="fas fa-file-excel mr-2"></i> スプレッドシートに保存</span>
                <div class="spinner" id="loading-spinner"></div>
            </button>
        </div>
        
        <button onclick="location.reload()" class="text-gray-400 underline text-sm mt-6 hover:text-gray-600">新しい案件を入力する</button>
    </div>
</div>

<div class="nav-buttons"><button id="btn-next" class="btn-nav" onclick="nextSlide()">次へ <i class="fas fa-chevron-right"></i></button></div>

    <script>
        /* JS（動き）を貼り付ける場所// ★★★★★ 重要：ここにコピーしたGASウェブアプリのURLを貼り付けてください ★★★★★
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzkrHLrLPO1kQ5iQzCxvMwEp6fvjKPPvRXnNWYSEO6gFOm0_bRy5grtIghwR9xqoyxj/exec"; 
// ★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★

let currentSlideIndex = 0;
// CodePenではdocument.querySelectorAll('.slide')はinit()が動く前に実行されないため、
// 実行時に取得するように修正します
let slides; 
const progressBar = document.getElementById('progressBar');
const btnNext = document.getElementById('btn-next');
let formData = {};
let totalSlides;

function init() {
    // スライドの要素を取得
    slides = document.querySelectorAll('.slide');
    if (slides.length < 2) {
        // スライドが見つからない場合はエラーを出す（念のため）
        console.error("Error: Slides not found. HTML structure might be incomplete.");
        return;
    }
    // イントロ(0)と結果画面(slides.length - 1)を除いた質問の総数
    totalSlides = slides.length - 2; 

    updateUI();
    // キーボード操作のイベントリスナーは元のコードの機能を維持します
    document.addEventListener('keydown', function(e) {
        if(e.key === 'Enter' && !e.shiftKey && btnNext.classList.contains('active')) {
            if(document.activeElement.tagName !== 'TEXTAREA') nextSlide();
        }
    });
}

function updateUI() {
    // スライドの表示/非表示を切り替える処理は元のコードのスタイルを維持します
    slides.forEach((slide, index) => {
        slide.classList.remove('active', 'prev');
        if (index === currentSlideIndex) {
            slide.classList.add('active');
        } else if (index < currentSlideIndex) {
            slide.classList.add('prev');
        }
    });

    // プログレスバーの更新
    const questionIndex = currentSlideIndex - 1;
    const progress = questionIndex >= 0 && questionIndex <= totalSlides ? (questionIndex / totalSlides) * 100 : 0;
    progressBar.style.width = `${progress}%`;

    // 「次へ」ボタンの活性化チェックは元のコードのスタイルを維持します
    if (currentSlideIndex > 0 && currentSlideIndex < slides.length - 1) {
        const currentInput = slides[currentSlideIndex].querySelector('input[type="text"], input[type="number"], input[type="date"], textarea, select, input[type="hidden"]');
        checkInput(currentInput);
        btnNext.style.display = 'flex';
    } else if (currentSlideIndex === slides.length - 1) {
        // 結果画面ではボタンを非表示にし、結果を生成します
        btnNext.style.display = 'none';
        generateResult();
    } else {
        // Intro画面
        btnNext.classList.add('active');
        btnNext.style.display = 'flex';
    }
}

function nextSlide() {
    if (currentSlideIndex < slides.length - 1) {
        // データ保存は元のコードの呼び出し方法を維持します
        saveCurrentFormData();
        currentSlideIndex++;
        updateUI();
    }
}


// --- フォームデータの保存 (データ構造のみ最新版に対応) ---
function saveCurrentFormData() {
    // Q1. 契約の種別
    formData['契約の種別'] = document.getElementById('input-contract')?.value || '';
    // Q2. 業務内容
    formData['業務内容'] = document.getElementById('input-job-desc')?.value || '';
    // Q3. 就業場所
    formData['就業場所'] = document.getElementById('input-location')?.value || '';
    // Q4. 期間
    formData['開始日'] = document.getElementById('input-start-date')?.value || '';
    formData['終了予定日'] = document.getElementById('input-end-date')?.value || '';
    // Q5. 勤務時間と休日
    formData['勤務時間・休日'] = document.getElementById('input-time')?.value || '';
    // Q6. 時間外労働
    formData['時間外労働の有無'] = document.getElementById('input-overtime')?.value || '無';
    if (formData['時間外労働の有無'] === '有') {
        formData['残業上限_日'] = document.getElementById('input-overtime-day')?.value || '0';
        formData['残業上限_週'] = document.getElementById('input-overtime-week')?.value || '0';
        formData['残業上限_月_時間'] = document.getElementById('input-overtime-month-hours')?.value || '0';
        formData['残業上限_月_日数'] = document.getElementById('input-overtime-month-days')?.value || '0';
    } else {
        formData['残業上限_日'] = '無';
        formData['残業上限_週'] = '無';
        formData['残業上限_月_時間'] = '無';
        formData['残業上限_月_日数'] = '無';
    }
    // Q7. 人数
    formData['必要人数'] = document.getElementById('input-headcount')?.value || '';
    // Q8. 単価
    formData['単価_免許なし'] = document.getElementById('input-price-nomental')?.value || '';
    formData['単価_免許あり'] = document.getElementById('input-price-mental')?.value || '';
    // Q9. 指揮命令者
    formData['指揮命令者'] = document.getElementById('input-leader-name')?.value || '';
    // Q10. 苦情処理者
    formData['苦情処理_役割'] = document.getElementById('input-complaint-role')?.value || '';
    if (formData['苦情処理_役割'] === 'その他') {
        formData['苦情処理_氏名'] = document.getElementById('input-complaint-name')?.value || '';
        formData['苦情処理_連絡先'] = document.getElementById('input-complaint-contact')?.value || '';
    } else {
        formData['苦情処理_氏名'] = '指揮命令者と同じ';
        formData['苦情処理_連絡先'] = '指揮命令者と同じ';
    }
    // Q11. 派遣元責任者
    formData['派遣元責任者'] = document.getElementById('input-our-pic')?.value || '';
    // Q12. 寮
    formData['寮の準備'] = document.getElementById('input-dorm')?.value || '';
    // Q13. 送迎
    formData['送迎_方法'] = document.getElementById('input-transport')?.value || '';
    if (formData['送迎_方法'] === '自力通勤') {
        formData['自力通勤_手段'] = document.getElementById('input-transport-means')?.value || '';
        formData['自力通勤_備考'] = document.getElementById('input-transport-note')?.value || '';
    } else {
        formData['自力通勤_手段'] = '該当なし';
        formData['自力通勤_備考'] = '該当なし';
    }
    // Q14. 便宜の供与
    formData['便宜の供与'] = document.getElementById('input-convenience')?.value || '';
    // Q15. 福利厚生
    formData['福利厚生施設の利用等'] = document.getElementById('input-welfare')?.value || '';
    // Q16. 営業担当者
    formData['営業担当者'] = document.getElementById('input-pic')?.value || '';
    // Q17. 備考
    formData['備考'] = document.getElementById('input-notes')?.value || '';
    
    // Slack題名用のキー
    formData['企業名'] = '【要入力】'; 
    formData['企業住所'] = '【要入力】';
}


// --- 入力チェック (元のコードの機能を維持) ---
function checkInput(element) {
    const currentSlide = slides[currentSlideIndex];
    let isComplete = true;

    // (中略: 入力チェックロジックは元のコードの機能を維持)
    if (currentSlideIndex === 1) { 
        isComplete = document.getElementById('input-contract').value !== '';
    } else if (currentSlideIndex === 4) { 
        isComplete = document.getElementById('input-start-date').value !== '' && document.getElementById('input-end-date').value !== '';
    } else if (currentSlideIndex === 6) { 
        const overtime = document.getElementById('input-overtime').value;
        isComplete = overtime !== '';
        if (overtime === '有') {
            isComplete = isComplete && (document.getElementById('input-overtime-month-hours').value !== '' || document.getElementById('input-overtime-month-days').value !== '');
        }
    } else if (currentSlideIndex === 8) { 
        isComplete = document.getElementById('input-price-nomental').value !== '';
    } else if (currentSlideIndex === 10) { 
        const complaintRole = document.getElementById('input-complaint-role').value;
        isComplete = complaintRole !== '';
        if (complaintRole === 'その他') {
            isComplete = isComplete && document.getElementById('input-complaint-name').value !== '' && document.getElementById('input-complaint-contact').value !== '';
        }
    } else if (currentSlideIndex === 13) { 
        const transport = document.getElementById('input-transport').value;
        isComplete = transport !== '';
        if (transport === '自力通勤') {
            isComplete = isComplete && document.getElementById('input-transport-means').value !== '';
        }
    } else if (currentSlideIndex > 0 && currentSlideIndex < slides.length - 1) {
        const inputElement = currentSlide.querySelector('input[type="text"], input[type="number"], input[type="date"], textarea, select');
        if (inputElement) {
            isComplete = inputElement.value.trim() !== '';
        }
    } else {
        isComplete = true;
    }

    if (isComplete) {
        btnNext.classList.add('active');
    } else {
        btnNext.classList.remove('active');
    }
}

// --- 以下、元のアプリの選択・表示制御・コピー・シート送信機能 (機能を維持) ---

function selectChoice(inputId, value) {
    const inputElement = document.getElementById(inputId);
    inputElement.value = value;
    
    const buttons = inputElement.parentElement.querySelectorAll('.btn-choice');
    buttons.forEach(btn => btn.classList.remove('selected'));
    if (event && event.currentTarget) {
        event.currentTarget.classList.add('selected');
    }

    checkInput(inputElement);
}

function toggleExtraTimeInputs(inputId, value, show) {
    selectChoice(inputId, value);
    const fields = document.getElementById('extra-time-fields');
    if (show) {
        fields.style.display = 'block';
    } else {
        fields.style.display = 'none';
        document.getElementById('input-overtime-day').value = '';
        document.getElementById('input-overtime-week').value = '';
        document.getElementById('input-overtime-month-hours').value = '';
        document.getElementById('input-overtime-month-days').value = '';
    }
}

function toggleComplaintInputs(inputId, value, show) {
    selectChoice(inputId, value);
    const fields = document.getElementById('complaint-fields');
    if (show) {
        fields.style.display = 'block';
    } else {
        fields.style.display = 'none';
        document.getElementById('input-complaint-name').value = '';
        document.getElementById('input-complaint-contact').value = '';
    }
}

function selectChoiceAndShowNote(inputId, value) {
    selectChoice(inputId, value);
    const fields = document.getElementById('transport-self-fields');
    if (value === '自力通勤') {
        fields.style.display = 'block';
    } else {
        fields.style.display = 'none';
        document.getElementById('input-transport-means').value = '';
        document.getElementById('input-transport-note').value = '';
    }
}


// --- 結果生成 (元のアプリの出力を維持) ---
function generateResult() {
    saveCurrentFormData(); 
    const outputDiv = document.getElementById('result-output');
    
    // Slackコピー用のテキストを生成（この出力形式も元のアプリの慣習を維持）
    let resultText = "【スグクル商談シート v3.2 登録情報】\n";
    resultText += "--------------------------------------\n";

    resultText += `契約種別: ${formData['契約の種別']}\n`;
    resultText += `業務内容: ${formData['業務内容'].replace(/\n/g, ' ')}\n`;
    resultText += `就業場所: ${formData['就業場所'].replace(/\n/g, ' ')}\n`;
    resultText += `期間: ${formData['開始日']} 〜 ${formData['終了予定日']}\n`;
    resultText += `勤務時間・休日: ${formData['勤務時間・休日'].replace(/\n/g, ' ')}\n`;
    
    let overtimeText = formData['時間外労働の有無'];
    if (overtimeText === '有') {
        overtimeText += ` (日:${formData['残業上限_日']}H, 週:${formData['残業上限_週']}H, 月:${formData['残業上限_月_時間']}H/${formData['残業上限_月_日数']}回)`;
    }
    resultText += `時間外労働: ${overtimeText}\n`;
    
    resultText += `必要人数: ${formData['必要人数']}名\n`;
    resultText += `単価(無): ¥${formData['単価_免許なし']}\n`;
    if (formData['単価_免許あり']) {
        resultText += `単価(有): ¥${formData['単価_免許あり']}\n`;
    }

    resultText += `指揮命令者: ${formData['指揮命令者']}\n`;
    if (formData['苦情処理_役割'] === 'その他') {
        resultText += `苦情処理者(先): ${formData['苦情処理_氏名']} (${formData['苦情処理_連絡先']})\n`;
    } else {
        resultText += `苦情処理者(先): 指揮命令者と同じ\n`;
    }
    resultText += `派遣元責任者: ${formData['派遣元責任者']}\n`;

    resultText += `寮の準備: ${formData['寮の準備']}\n`;
    let transportDisplay = formData['送迎_方法'];
    if (transportDisplay === '自力通勤') {
        transportDisplay += ` (手段:${formData['自力通勤_手段']}, 備考:${formData['自力通勤_備考']})`;
    }
    resultText += `送迎・通勤: ${transportDisplay}\n`;

    resultText += `便宜の供与: ${formData['便宜の供与']}\n`;
    resultText += `福利厚生: ${formData['福利厚生施設の利用等']}\n`;
    resultText += `営業担当者: ${formData['営業担当者']}\n`;
    resultText += "--------------------------------------\n";
    resultText += `備考: ${formData['備考']}\n`;
    
    outputDiv.textContent = resultText;
}

// --- Slackコピー機能 (元のアプリの機能を維持) ---
function copyText() {
    const textToCopy = document.getElementById('result-output').textContent;
    navigator.clipboard.writeText(textToCopy).then(() => {
        alert('Slack用のテキストをコピーしました！');
    }).catch(err => {
        console.error('コピーに失敗しました', err);
        alert('コピーに失敗しました。コンソールを確認してください。');
    });
}

// --- Google Sheet 送信機能 (元のアプリの機能を維持) ---
function sendToSheet() {
    if (SCRIPT_URL === "ここにウェブアプリのURLを貼り付けてください") {
        alert("エラー: SCRIPT_URLが設定されていません。HTMLの先頭にあるコメントを確認してください。");
        return;
    }

    saveCurrentFormData(); 

    const btn = document.getElementById('btn-send-sheet');
    const spinner = document.getElementById('loading-spinner');
    btn.disabled = true;
    btn.innerHTML = `<span>送信中...</span>`;
    spinner.style.display = 'block';

    // タイムスタンプを追加
    formData['タイムスタンプ'] = new Date().toLocaleString("ja-JP");

    // GASに送るためのURLパラメータを生成
    const keys = Object.keys(formData);
    const params = keys.map(key => {
        const value = String(formData[key]).replace(/\n/g, ' ');
        return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;
    }).join('&');

    const url = `${SCRIPT_URL}?${params}`;
    
    fetch(url, { method: 'GET', mode: 'no-cors' }) 
        .then(() => {
            btn.innerHTML = `<span><i class="fas fa-check mr-2"></i> 保存完了！</span>`;
            btn.classList.remove('bg-green-600', 'hover:bg-green-700');
            btn.classList.add('bg-blue-600');
            spinner.style.display = 'none';
        })
        .catch(error => {
            btn.innerHTML = `<span><i class="fas fa-exclamation-triangle mr-2"></i> 送信エラー</span>`;
            btn.classList.remove('bg-green-600');
            btn.classList.add('bg-red-600');
            spinner.style.display = 'none';
            alert("データの送信中にエラーが発生しました。コンソールを確認してください。");
        });
}

// HTMLの読み込みが完了した後に実行されるようにする
document.addEventListener('DOMContentLoaded', init); */
    </script>
</body>
</html>